
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Running the Cloud Native Toolkit locally" name="description"/>
<meta content="Brian Innes" name="author"/>
<link href="https://binnes.github.io/cloud-native-toolkit/localCloudNativeToolkit.html" rel="canonical"/>
<link href="assets/images/favicon.png" rel="shortcut icon"/>
<meta content="mkdocs-1.1.2, mkdocs-material-6.2.5" name="generator"/>
<title>Local cluster - Local Cloud Native Toolkit</title>
<link href="assets/stylesheets/main.15aa0b43.min.css" rel="stylesheet"/>
<link href="assets/stylesheets/palette.75751829.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
<link href="css/extra.css" rel="stylesheet"/>
<link href="css/pdf-print.css" rel="stylesheet"/>
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-172132667-1","binnes.github.io/cloud-native-toolkit"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script>
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
</head>
<body data-md-color-accent="none" data-md-color-primary="none" data-md-color-scheme="" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#where-to-run-the-cloud-native-toolkit">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header-nav md-grid">
<a aria-label="Local Cloud Native Toolkit" class="md-header-nav__button md-logo" href="https://binnes.github.io/cloud-native-toolkit/" title="Local Cloud Native Toolkit">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
<label class="md-header-nav__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header-nav__title" data-md-component="header-title">
<div class="md-header-nav__ellipsis">
<div class="md-header-nav__topic">
<span class="md-ellipsis">
            Local Cloud Native Toolkit
          </span>
</div>
<div class="md-header-nav__topic">
<span class="md-ellipsis">
            
              Local cluster
            
          </span>
</div>
</div>
</div>
<label class="md-header-nav__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header-nav__source">
<a class="md-source" href="https://github.com/binnes/cloud-native-toolkit/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    binnes/cloud-native-toolkit
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Local Cloud Native Toolkit" class="md-nav__button md-logo" href="https://binnes.github.io/cloud-native-toolkit/" title="Local Cloud Native Toolkit">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
    Local Cloud Native Toolkit
  </label>
<div class="md-nav__source">
<a class="md-source" href="https://github.com/binnes/cloud-native-toolkit/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    binnes/cloud-native-toolkit
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="index.html">
        Home
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="WhereToRun.html">
        Target environment
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Local cluster
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="localCloudNativeToolkit.html">
        Local cluster
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#low-resources-environment">
    Low Resources environment
  </a>
<nav aria-label="Low Resources environment" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#minimum-environment">
    Minimum Environment
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#enhanced-environment">
    Enhanced Environment
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#challenges-of-running-locally">
    Challenges of running locally
  </a>
<nav aria-label="Challenges of running locally" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#dns-name-resolution">
    DNS - Name resolution
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tls-certificates">
    TLS Certificates
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#inbound-connectivity-to-trigger-pipelines">
    Inbound connectivity to trigger pipelines
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="day1.html">
        Day1 differences
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#low-resources-environment">
    Low Resources environment
  </a>
<nav aria-label="Low Resources environment" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#minimum-environment">
    Minimum Environment
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#enhanced-environment">
    Enhanced Environment
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#challenges-of-running-locally">
    Challenges of running locally
  </a>
<nav aria-label="Challenges of running locally" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#dns-name-resolution">
    DNS - Name resolution
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tls-certificates">
    TLS Certificates
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#inbound-connectivity-to-trigger-pipelines">
    Inbound connectivity to trigger pipelines
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/binnes/cloud-native-toolkit/edit/master/docs/localCloudNativeToolkit.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1 id="where-to-run-the-cloud-native-toolkit">Where to run the Cloud Native Toolkit<a class="headerlink" href="#where-to-run-the-cloud-native-toolkit" title="Permanent link">¶</a></h1>
<p>The <a href="https://cloudnativetoolkit.dev">Cloud Native Toolkit</a> is typically run within <a href="https://www.ibm.com/cloud/openshift">Open Shift running on the IBM Cloud</a>, however this is not always ideal for learning.  Sometime a developer wants a local option, where everything can run on their own hardware, maybe where connectivity isn't always guaranteed.  There are other times where a developer may want to dig a little deeper, so wants an isolated environment, where they can experiment without fear of breaking other members of their team, so again want an isolated environment where they have admin permissions.</p>
<p>Having access to a longer term, no cost environment can also give a developer time to do deeper learning</p>
<p>This is why this project exists.  To take the Cloud Native toolkit and allow it to be run in an isolated environment with lower resources than would typically be available in a cloud environment.</p>
<h2 id="low-resources-environment">Low Resources environment<a class="headerlink" href="#low-resources-environment" title="Permanent link">¶</a></h2>
<p>One of the challenges of working with a local install is that the software stack is designed to run in a cloud environment, where resources are more abundant, and typically designed to serve a large user population.  This can make it challenging to replicate on a laptop or developer workstation.</p>
<p>There are also capabilities which are assumed in a cloud environment, which may not exist when running locally, such as inbound connectivity.</p>
<p>This project aims to provide 'as close as is possible' developer experience to the primary target environment on the cloud, but running locally on a laptop or developer workstation.</p>
<h3 id="minimum-environment">Minimum Environment<a class="headerlink" href="#minimum-environment" title="Permanent link">¶</a></h3>
<p>The minimum resources needed to run the toolkit on a laptop or developer workstation is a machine with 16GB memory.  The target is to support modern versions of Linux, MacOS and Windows operating systems, but currently only MacOS has been tested</p>
<p>The minimum environment run on top of Minikube rather than OpenShift, as Minikube reduces memory requirements at the cost of the richer cloud platform and the enhanced developer experience provided by OpenShift.</p>
<h3 id="enhanced-environment">Enhanced Environment<a class="headerlink" href="#enhanced-environment" title="Permanent link">¶</a></h3>
<p>A better developer experience can be obtained where a laptop of developer workstation has more memory available, 24GB or greater.  This can then use <a href="https://developers.redhat.com/products/codeready-containers/overview">Code Ready Containers - crc</a> or the <a href="https://www.okd.io/crc.html">Open Source community distribution based version - okd</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use the <a href="https://cloudnativetoolkit.dev">Cloud Native Toolkit</a> instructions to setup this environment.  The project has not yet created the assets to install a stand-alone version of the toolkit based on OpenShift (crc/okd).</p>
</div>
<h2 id="challenges-of-running-locally">Challenges of running locally<a class="headerlink" href="#challenges-of-running-locally" title="Permanent link">¶</a></h2>
<p>Running the environment locally does pose some challenges to deliver a good developer workflow:</p>
<h3 id="dns-name-resolution">DNS - Name resolution<a class="headerlink" href="#dns-name-resolution" title="Permanent link">¶</a></h3>
<p>When you deploy workloads on a cloud your browser and clients of the workloads need to be able to reach the workloads.  Facilities like the Ingress controller within the cloud infrastructure will route traffic within the cloud, but a browser still needs to be able to get to the cloud.  With public cloud hosted services, the Internet DNS service enables name resolution to an IP address, but such services are not available for local kubernetes clusters, unless you setup and configure your own DNS server or manually configure mappings for all services on your workstation.</p>
<p>To overcome this issue the <a href="https://nip.io"><strong>nip.io</strong></a> name resolution service is used by the project.  This does require an outbound internet connection to work, but solves name resolution issues for workloads deployed to a local kubrnetes cluster.  </p>
<p>The service works by including the cluster IP address in the URL.  Service URLs need to be in the form of [service name].[ip address].nip.io and they will resolve the to IP address included in the URL.  </p>
<p>This project sets the cluster domain to [minikube ip address].nip.io, so all ingress hostnames will have a valid nip.io format and all will resolve to the kubernetes IP address.</p>
<p>If you need to run in a disconnected environment then a DNS server, such as <strong>dnsmasq</strong> needs to be installed and configured in your local network/workstation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is on the todo list to provide instructions to implement local DNS</p>
</div>
<h3 id="tls-certificates">TLS Certificates<a class="headerlink" href="#tls-certificates" title="Permanent link">¶</a></h3>
<p>Secure communication is provided by TLS based on certificates and a set of trusted certificate authorities.  The public certificates for these trusted certificate issuing authorities are included in operating systems and some browsers.  When working with services accessible over this internet then you can configure a cluster to dynamically request certificates or purchase certificates for use within an enterprise.  However, to use free certificate authorities, such as <a href="https://letsencrypt.org">LetsEncrypt</a> you need to verify you control the domain you are requesting a certificate for, so need to setup a server to accept incoming requests for that domain, as registered in public DNS servers.</p>
<p>With a local setup it is not always possible to set this up and where it is possible it is often not trivial.  Having to use a traffic forwarding service, dynamic DNS forwarder, etc.  then having to configure your service provider router or modem to forward traffic within your local network.  If working at a hotspot or with certain internet service providers it is not possible to accept inbound traffic, so an alternate solution is needed to provide SSL/TLS certificates.</p>
<p>This project creates a self-signed root Certificate Authority (CA) certificate, then issues a wildcard server certificate to the cluster *[minikube IP address].nip.io, which is signed by the self-signed root CA certificate.  You need to add and trust the public certificate of the self-signed root CA to your OS/browser then all services offered by the local cluster will be trusted and you won't receive any browser warnings.  Any application or services that need to access a cluster service will also need to have the root CA public certificate added to their host OS to allow them to communicate securely without reporting certificate authorisation errors.</p>
<p>This approach works for disconnected or connected working, once the CA root public certificate is trusted.</p>
<h3 id="inbound-connectivity-to-trigger-pipelines">Inbound connectivity to trigger pipelines<a class="headerlink" href="#inbound-connectivity-to-trigger-pipelines" title="Permanent link">¶</a></h3>
<p>The Cloud Native Toolkit relies heavily on the source control system, usually github.  However, part of the workflow requires git hooks to fire and initiate actions within the development environment.  When running on public cloud infrastructure github.com is able to connect with the required services running the developer workflow, but in a local environment this is not possible.  </p>
<p>To provide the integrated developer workflow this project installs a private git service on the cluster, so git hooks can be configured to initiate workflows within the local cluster.  </p>
<p>The current choice of private git service is <a href="https://gitea.io">Gitea</a>, but the Cloud Native Toolkit has just added support for <a href="https://gogs.io">Gogs</a>, so it may be preferable to adopt that in the future?</p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href="WhereToRun.html" rel="prev">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Target environment
              </div>
</div>
</a>
<a class="md-footer-nav__link md-footer-nav__link--next" href="day1.html" rel="next">
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Day1 differences
              </div>
</div>
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
 ... <a class="link--pdf-download" download href="pdf/LocalCloudNativeToolkit.pdf" title="PDF">download PDF</a></div>
</div>
</div>
</footer>
</div>
<script src="assets/javascripts/vendor.93c04032.min.js"></script>
<script src="assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
<script>
        app = initialize({
          base: ".",
          features: [],
          search: Object.assign({
            worker: "assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
</body>
</html>